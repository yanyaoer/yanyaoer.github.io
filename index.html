<!doctype html><html><head><meta name=generator content="Hugo 0.68.3"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>yÃ¡nyÃ o.com</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=http://y%C3%A1ny%C3%A0o.com/index.xml title=yÃ¡nyÃ o.com><meta property="og:title" content="yÃ¡nyÃ o.com"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="http://y%C3%A1ny%C3%A0o.com/"><meta property="og:updated_time" content="2020-05-15T09:45:08+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="yÃ¡nyÃ o.com"><meta name=twitter:description content><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=http://y%C3%A1ny%C3%A0o.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=http://y%C3%A1ny%C3%A0o.com/css/main.css><script src=http://y%C3%A1ny%C3%A0o.com/js/main.js></script></head><body><div class="container wrapper"><div class=header><h1 class=site-title><a href=http://y%C3%A1ny%C3%A0o.com/>yÃ¡nyÃ o.com</a></h1><div class=site-description><nav class="nav social"><ul class=flat></ul></nav></div><nav class=nav><ul class=flat></ul></nav></div><div class="recent-posts section"><h2 class=section-header>Recent posts</h2><div class=posts><div class=post><div class=meta>May 15, 2020</div><a class=title href=/posts/mastodon/>Mastodon</a> &mdash;
<span class=description>Mastodon é•¿æ¯›è±¡1 &ndash; åŸºäº rubyonrails/reactjs/nodejs å¼€å‘çš„åˆ†å¸ƒå¼ & å»ä¸­å¿ƒåŒ– twiter cloneã€‚åˆ©ç”¨ç©ºé—²æ—¶é—´åœ¨ aws lightsail ä¸Šå¼€äº†ä¸ªå®ä¾‹æŠŠæœåŠ¡è·‘äº†èµ·æ¥
ä¸€å¼€å§‹èµ°äº†äº›å¼¯è·¯ï¼Œå› ä¸ºé€‰æœºæˆ¿å’Œçœé’±çš„ç¼˜æ•…ï¼Œé‡å»ºäº†è‹¥å¹²æ¬¡æ“ä½œç³»ç»Ÿï¼Œæœ€åçš„é€‰æ‹©æ˜¯ tokyo+cloudflareï¼Œæ²¡é”™æˆ‘åˆå¥—äº† cdnï¼Œå®åœ¨æ˜¯æµ·å¤–çº¿è·¯åˆ°åŒ—äº¬è”é€šä¸ç¨³å®š
å®‰è£…æ­¥éª¤æ²¡æœ‰ä½¿ç”¨ docker è€Œæ˜¯å‚è€ƒæ–‡æ¡£ä»æºç å®‰è£…2ï¼ŒåŸå› å’Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š
æœºå™¨æ˜¯ $3.5/mo 512mem æœ€ä¾¿å®œçš„é‚£æ¡£ï¼Œ~æ²¡é”™æˆ‘åˆæ¶ˆè´¹é™çº§äº†~ï¼Œå‡ºäº net/io æ€§èƒ½è€ƒè™‘ï¼Œè¿™é‡Œå°±ä¸ä½¿ç”¨ docker å•¦
å†…å­˜é—®é¢˜ï¼ŒRAILS_ENV=production bundle exec rake mastodon:setup è¿™ä¸€æ­¥éª¤æ‰§è¡Œåˆ° rails assets:precompileï¼Œ ä¸ç®¡æ˜¯åœ¨ docker é‡Œè·‘è¿˜æ˜¯ç›´æ¥è¿è¡Œéƒ½ä¼šæŠ¥ swap åˆ†åŒºä¸è¶³ï¼Œæ‰¾åˆ°ä¸¤ä¸ªæ–¹æ¡ˆæ¥è§£å†³:
# create swapfile &lt;https://linuxize.com/post/create-a-linux-swap-file/> $ sudo fallocate -l 2G /swapfile $ sudo chmod 600 /swapfile $ sudo mkswap /swapfile $ sudo swapon /swapfile # verify active $ sudo swapon --show # optional: low value is better for production $ sudo sysctl vm.&mldr;</span></div><div class=post><div class=meta>May 9, 2020</div><a class=title href=/posts/gitlab-repo/>Gitlab Repo</a> &mdash;
<span class=description>gitlab é‡Œé¢å·²ç»æœ‰åæ¥ä¸ª groupï¼Œå‡ ç™¾ä¸ª projectï¼Œè™½ç„¶ä¸ä¸€å®šä¼šæ¯ä¸ªé¡¹ç›®éƒ½å‚ä¸ï¼Œ ä½†æ˜¯ä¸ºäº†å¿«é€ŸåŒæ­¥ä»£ç ï¼Œåˆæ¡èµ·äº† android å¼€å‘å¸¸ç”¨çš„ repo å‘½ä»¤æ¥ç®¡ç†å¤šé¡¹ç›®ä»£ç ã€‚ è¿™é‡Œä½¿ç”¨äº† gitlab graphql æ¥å£æ¥éå†é¡¹ç›®ç”Ÿæˆåˆ†ç»„çš„ manifest æ–‡ä»¶
#!/usr/bin/env python import argparse import json import os import urllib2 GITLAB_HOST = "gitlab.mydomain.com" GITLAB_SSH_URL = "ssh://git@" + GITLAB_HOST GITLAB_GRAPHQL_URL = "https://" + GITLAB_HOST + "/api/graphql" GITLAB_TOKEN = "" GITLAB_GROUP = [""] BLACK_LIST = ("",) # ä»¥ä¸Šé…ç½®ä¿®æ”¹ä¸ºè‡ªå·±çš„è®¾å®š template = """&lt;?xml version="1.0" encoding="UTF-8"?> &lt;!-- autogen by gen.py, do not edit this file --> &lt;manifest> &lt;remote name="origin" fetch="{ssh_url}" /> &lt;default revision="master" remote="origin" sync-c="true" sync-j="4" /> {content} &lt;/manifest>""" def write_file(content, filename="default.&mldr;</span></div><div class=post><div class=meta>May 7, 2020</div><a class=title href=/posts/dash-replacement/>Dash Replacement with tmux</a> &mdash;
<span class=description>é€šè¿‡ tmux å¿«æ·é›†æˆæ›¿æ¢ dash.app æŸ¥è¯¢å¼€å‘æ–‡æ¡£
$ brew install dasht $ dasht-docsets | tr 'A-Z' 'a-z' go javascript python_3 rust tornado # tmux.conf quick start bind -n S-up command-prompt -p 'docset:' "splitw -h -fb -l 80 dasht '%%'" &mldr;</span></div><div class=post><div class=meta>May 7, 2020</div><a class=title href=/posts/cloudflare-gost/>Cloudflare Gost</a> &mdash;
<span class=description>ä»æ¸…æ˜èŠ‚å¼€å§‹ï¼Œç¨³å®šè¿è¡Œå¥½å‡ å¹´çš„ ss æœåŠ¡å™¨ç»ˆäºé˜µäº¡äº†ï¼Œæ‰€æœ‰ç«¯å£å…¨æŒ‚ã€‚ä¸€ç›´è¹­å…¬å¸çš„ vpn æŸ¥èµ„æ–™ä¹ŸæŒºåˆ°äº†äº”ä¸€ï¼Œå®åœ¨æ‹–å»¶å¤Ÿå¤Ÿçš„å°±å†å¦å¤–å¼€äº†ä¸€å°æœºå™¨ä¸­è½¬è¿‡å»è¿ç§»æ•°æ®ï¼Œä¸è¿‡å˜›å¹´çºªå¤§äº†åˆå¼€å§‹çŠ¯æ‡’ï¼Œä¼å›¾æ‹¯æ•‘è·å¾—èµ„æ ¼è®¤è¯çš„æœºå™¨ï¼Œé€šè¿‡ä¸€ç•ªç½‘ä¸Šå†²æµªå­¦ä¹ åˆ°äº†ç›®å‰(å®æµ‹å¯ç”¨)èƒ½æ»¡è¶³æˆ‘éœ€æ±‚çš„æ–¹æ¡ˆã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼šcloudflare[åæ–‡ç®€ç§°ä¸º cf] + websockets over gostï¼Œå®é™…çš„å®¢æˆ·ç«¯é€šè¿‡ cdn ä»£ç†å†æ¥å…¥æœåŠ¡
æœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š
gost å¯åŠ¨æ—¶ç»‘å®šçš„ localhost ä¸ç›´æ¥å¯¹å¤–è®¿é—®ï¼Œèµ°äº† caddy çš„è½¬å‘ï¼Œè€Œè¿™ä¸€æ­¥å’Œ cf çš„ ssl è¯ä¹¦é…ç½®ä¼šé€ æˆä¸åœçš„é‡å®šå‘è·³è½¬ï¼Œéœ€è¦å°† cf åŠ å¯†æ¨¡å¼é…ç½®ä¸º flexible
ç„¶åä¿®æ”¹ caddy çš„åŸŸåé…ç½®ä¸º http://domain.com https://domain.com { &mldr; } é˜»æ­¢ cf å’Œ caddy ä¹‹é—´çš„ http -> https
gost æœåŠ¡ç«¯ç›‘å¬ ws åè®®ï¼Œæœ¬åœ°çš„ gost å®¢æˆ·ç«¯è½¬å‘ wss åè®®è¿æ¥ cf_domain:443
éœ€è¦é‰´æƒçš„æ–¹æ¡ˆä½¿ç”¨ socks5+wss://username:password@domain:port
android å®¢æˆ·ç«¯çš„è®¾ç½®ï¼Œå› ä¸ºä½¿ç”¨äº† ws åè®®ï¼Œæ‰€ä»¥éœ€è¦å°†åŸŸåå†™å…¥åˆ°æ’ä»¶çš„é…ç½®é‡Œï¼Œç›´æ¥ç”¨åŸŸåå˜é‡æ— æ³•è§£æ
å…·ä½“é…ç½®å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œä¸€åˆ‡æµªè´¹çš„æ—¶é—´éƒ½æ˜¯æºäºæ²¡è®¤çœŸä»”ç»†çœ‹æ–‡æ¡£&mldr;</span></div><div class=post><div class=meta>Jan 13, 2017</div><a class=title href=/posts/webpack-resolve-local-module/>webpack resolve local module</a> &mdash;
<span class=description>æœ€è¿‘çš„é¡¹ç›®åˆšå¼€å§‹ï¼Œè®¾è®¡çš„ç›®å½•å±‚çº§æœ‰ç‚¹æ·±
ç»å¸¸ä¼šåœ¨å¥½å‡ å±‚æœ¬åœ°è·¯å¾„ä¹‹é—´äº’ç›¸å¼•ç”¨
import Image from '../../../../components/image'
è¿™å±‚å±‚å å çš„è·¯å¾„å†™èµ·æ¥å®åœ¨ä¸‘é™‹
ä¸ç”±å¾—æƒ³èµ· Python ä»é¡¹ç›®æ ¹ç›®å½•å¼•ç”¨æ¨¡å—
ç„¶åç ”ç©¶äº†ä¸€ä¸‹ Node.js é‡Œçš„å‡ ç§ç®€æ˜“å®ç°
å¹²è„†åˆ©è½çš„è½¯è¿æ¥: ln -s node_modules src
ä¿®æ”¹ç¯å¢ƒå˜é‡: NODE_PATH=. node app
ä»æœ¬åœ°ç›®å½•å®‰è£…:
// package.json // éœ€è¦è¿è¡Œ npm install { "name": "baz", "dependencies": { "foo": "file: ./src", } } å¦å¤–è¿˜æœ‰äº›ä¿®æ”¹ globalï¼Œæˆ–è€…å¼•å…¥å…¶ä»– require å®ç°çš„æ–¹æ³•å°±ä¸å†ä¸€ä¸€åˆ—å‡ºäº†
æœ€ç»ˆé€‰æ‹©çš„æ˜¯ä¿®æ”¹ webpack é…ç½®
// webpack.config.js resolve: { modulesDirectories: [__dirname, 'node_modules'], } https://gist.github.com/branneman/8048520 http://stackoverflow.com/questions/10860244/how-to-make-the-require-in-node-js-to-be-always-relative-to-the-root-folder-of-t/41078266#41078266 https://webpack.github.io/docs/configuration.html#resolve-modulesdirectories&mldr;</span></div><div class=post><div class=meta>Oct 25, 2016</div><a class=title href=/posts/leonard-cohen-you-want-it-darker/>Leonard Cohen - you want it darker</a> &mdash;
<span class=description>å¹´åº¦æœ€ä½³
you want it darker
å¾ªç¯å¬äº†å¥½å‡ å¤©
å¹²å‡€ä½æ²‰çš„å—“éŸ³åŠ é…ä¹
æ„ˆå‘æ‹…å¿ƒä»¥åå¬ä¸åˆ°äº†æ€ä¹ˆåŠ ğŸ˜¢ï½&mldr;</span></div><div class=post><div class=meta>Jun 15, 2016</div><a class=title href=/posts/web-audio/>web audio</a> &mdash;
<span class=description>ç…§æ–‡æ¡£æ’¸äº†ä¸€ä¸‹ AudioContext å¯è§†åŒ–éŸ³é¢‘
æ¡Œé¢æµè§ˆå™¨ä¸Š Safari 9, Chrome stable ç»˜åˆ¶æ­£å¸¸
ç§»åŠ¨ç«¯åªæœ‰å¾®ä¿¡çš„ webview èƒ½å·¥ä½œ, çº¯ç©ç¥¨å» ref: https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API/Visualizations_with_Web_Audio_API
&lt;!DOCTYPE html> &lt;html> &lt;head> &lt;meta charset="utf-8"> &lt;meta name="viewport" content="width=device-width, user-scalable=no"> &lt;title>AV&lt;/title> &lt;/head> &lt;body> &lt;canvas id="vis">&lt;/canvas> &lt;audio id="av" src="YOUR_AUDIO_FILE">&lt;/audio> &lt;script src="index.js">&lt;/script> &lt;/body> &lt;/html> window.AudioContext = window.AudioContext || window.webkitAudioContext || window.mozAudioContext; window.onload = function(){ var canvas = document.getElementById('vis'); var canvasCtx = canvas.getContext('2d'); var isPlaying = true; var audio = document.getElementById('av'); var audioCtx = new AudioContext(); var analyser = audioCtx.&mldr;</span></div><div class=post><div class=meta>Apr 26, 2016</div><a class=title href=/posts/move-to-caddy/>move to caddy</a> &mdash;
<span class=description>å»å¹´ç”¨ Hexo æ­å»ºçš„æ—¥å¿—å·²ç»å¥½å‡ ä¸ªæœˆæ²¡æ›´æ–°äº†ï¼Œæœ€è¿‘ä¼‘å‡æœ‰ç‚¹ç©ºé—²å°±ç»§ç»­æ›´æ–°å§ã€‚
å…ˆä» Github è¿ç§»å›è‡ªå·±çš„ Linodeï¼Œç„¶åå®‰è£…ä¸€ä¸ª Caddyserver1 æ¥æ¸²æŸ“ markdown
Caddy is a unique web server with a modern feature set. Think nginx or Apache, but written in Go. With Caddy, you can serve your websites over HTTP/2. It can act as a reverse proxy and load balancer. Front your PHP apps with it. You can even deploy your site with git push. Cool, right?2
Download and install systemd wget -O 'caddy.&mldr;</span></div><div class=post><div class=meta>Dec 22, 2015</div><a class=title href=/posts/mongodb-backup/>mongodb backup</a> &mdash;
<span class=description>æœ‰å°æœºå™¨å‡†å¤‡2æœˆä»½ä¸‹æ¶ è®°ä¸€ä¸ª mongodb å¤‡ä»½å°è„šæœ¬ :)
#!/bin/bash # vim: set et sw=2 ts=2 sts=2 ff=unix fenc=utf8: MONGO_DATABASE="_name_" MONGO_HOST="_ip_" MONGO_PORT="_prot_" TIMESTAMP=`date +%Y-%m-%dT%H:%M:%S` MONGODUMP_PATH="/usr/bin/mongodump" BACKUPS_DIR="/data/dumps/" BACKUP_NAME="$MONGO_DATABASE-$TIMESTAMP" while test $# -gt 0 do case "$1" in -m) echo "backup mongthly and clear week_dir" #rm $BACKUPS_DIR"week/*" find $BACKUPS_DIR"week" -type f -name '*.tgz' -delete tar -czPf $BACKUPS_DIR"month/"$BACKUP_NAME.tgz $BACKUPS_DIR$MONGO_DATABASE ;; -w) echo "backup weekly" echo "tar -czPf $BACKUPS_DIR"week/"$BACKUP_NAME.tgz $BACKUPS_DIR$MONGO_DATABASE" ;; -d) echo "just dump" $MONGODUMP_PATH -d $MONGO_DATABASE --out $BACKUPS_DIR ;; *) echo "do nothing" ;; esac shift done # crontab -e 10 3 * * * /bin/bash $HOME/bin/mongobackup.&mldr;</span></div><div class=post><div class=meta>Dec 14, 2015</div><a class=title href=/posts/let-s-encrypt/>let's encrypt</a> &mdash;
<span class=description>Let&rsquo;s Encrypt å·²ç»å…¬å¼€æµ‹è¯•ï¼Œä¸éœ€è¦å†æäº¤æµ‹è¯•åŸŸåè¡¨å•ï¼Œç›´æ¥å°±èƒ½ç”³è¯·
å°é¡¹ç›®ä»¥åéƒ½èƒ½ç”¨è¿™ç©æ„å¼€ https ä¸ç”¨èŠ±é’±ä¹°è¯ä¹¦å“¦å•¦å•¦
ç…§ æ–‡æ¡£ åšä¸€éç»™åŸŸåç­¾ä¸Šè¯ä¹¦è¿˜æŒºç®€å•çš„
# è·å–é¡¹ç›®ä»£ç  git clone https://github.com/letsencrypt/letsencrypt cd letsencrypt # å®‰è£…ä¾èµ– ./letsencrypt-auto # è·å–è¯ä¹¦ ./letsencrypt-auto certonly --standalone -d www.example.com -d example.com # é…ç½® nginx server { listen 443 ; ssl on; ssl_certificate_key /etc/letsencrypt/live/youdomain/privkey.pem; ssl_certificate /etc/letsencrypt/live/youdomain/fullchain.pem; } éœ€è¦æ³¨æ„çš„æ˜¯ dnspod ç­‰å›½å†…æœåŠ¡è§£æåŸŸåæœ‰é—®é¢˜
æˆ‘è¿™é‡Œç›´æ¥åˆ‡å› domains.google.com å°±è¡Œäº†
ä½¿ç”¨ standalone æ¨¡å¼éœ€è¦å…ˆåœæ‰é»˜è®¤çš„ nginx
æ–‡æ¡£é‡Œæåˆ°å¯ä»¥ä½¿ç”¨ webroot æ¨¡å¼ä¸ç”¨åœ ä½†æˆ‘åˆ›å»ºéªŒè¯æ–‡ä»¶å¤±è´¥äº† :(
é»˜è®¤90å¤©è¿‡æœŸï¼Œå»ºè®® crontab å®šæ—¶æ›´æ–°
###Update
ä½¿ç”¨ acme.sh
An ACME protocol client written purely in Shell (Unix shell) language.&mldr;</span></div><ul class=pagination><li class="page-item page-prev"></li><li class="page-item page-next"><a href=/page/2/ class=page-link aria-label=Next><span aria-hidden=true>Next page â†’</span></a></li></ul></div></div></div><div class="footer wrapper"><nav class=nav><div><a href=https://github.com/vividvilla/ezhil>Ezhil theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></nav></div></body></html>